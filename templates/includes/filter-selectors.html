<!-- FILTER SELECTOR INCLUDE -->
<div id="filter_selectors_wrapper">
    <div id="filter_selectors">
        <input type="checkbox" data-semester="{{date.today().year-1}} 4" id="{{date.today().year-1}} 4" name="semester" />
        <label for="{{'%s' | format(date.today().year-1)}} 4">FS {{'%s' | format((date.today().year-1) % 100)}} </label>
        <input type="checkbox" data-semester="{{date.today().year-1}} 3" id="{{date.today().year-1}} 3" name="semester" />
        <label for="{{'%s' | format(date.today().year-1)}} 3">HS {{'%s' | format((date.today().year-1) % 100)}} </label>
        <input type="checkbox" data-semester="{{date.today().year}} 4" id="{{date.today().year}} 4" name="semester" />
        <label for="{{'%s' | format(date.today().year)}} 4">FS {{'%s' | format(date.today().year % 100)}} </label>
        <input type="checkbox" data-semester="{{date.today().year}} 3" id="{{date.today().year}} 3" name="semester" checked/>
        <label for="{{'%s' | format(date.today().year)}} 3">HS {{'%s' | format(date.today().year % 100)}} </label>
    </div>
    <!--hwat-->

    <script type="text/javascript">
        $('input[name="semester"]').change(function ShowSelectedSemester() {
            var modules_to_filter = new $(); 
            var year_semesters = {};
            $(`input[name="semester"]:not(:checked)`).each(function() {
                modules_to_filter=modules_to_filter.add($(`[data-semester*="${$(this).get(0).id}"]`).not(`[data-semester*="999"]`))
                var year = $(this).get(0).id.split(' ')[0]
                var semester = $(this).get(0).id.split(' ')[1]
                if(!(year in year_semesters)) {
                    year_semesters[year] = new Set();
                }
                year_semesters[year].add(semester);
            })
            $.each(year_semesters, (value, index) => {
                if(year_semesters[value].size == 2){
                    modules_to_filter=modules_to_filter.add($(`[data-semester*="${value}"]`));
                }
            });
            // console.log(modules_to_filter.length)
            $('[data-semester]').removeClass('hidden')
            $(modules_to_filter).addClass('hidden')
            return;
        });
        $( window ).on( "load", function() {
            ShowSelectedSemester();
        });
    </script>

    <style>
        input[type="radio"] {
        display:none;
        }
        input[type="checkbox"] {
            display:none;
        }
        label {
        border-radius: 5px;
        width:23%;
        float:left;
        text-align:center;
        background:#ffffff;
        box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
        color:#222222;
        padding:0.5%;
        margin:0.5%;
        margin-bottom:8px;
        cursor:pointer;

        }
        input[type="radio"][id="blue"]:checked + label {
        background:#6666ff;
        }
        input[type="radio"][id="blue"]:checked ~ .red, input[type="radio"][id="blue"]:checked ~ .green {
        width:0;
        height:0;
        padding:0;
        margin:0;
        opacity:0;
        }
        input[type="radio"][id="red"]:checked + label {
        background:#ff4466;
        }
        input[type="radio"][id="red"]:checked ~ .blue, input[type="radio"][id="red"]:checked ~ .green {
        width:0;
        height:0;
        padding:0;
        margin:0;
        opacity:0;
        }
        input[type="radio"][id="green"]:checked + label {
        background:#66dd99;
        }
        input[type="radio"][id="green"]:checked ~ .blue, input[type="radio"][id="green"]:checked ~ .red {
        width:0;
        height:0;
        padding:0;
        margin:0;
        opacity:0;
        }

        .tile {
        width:23%;
        height:100px;
        float:left;
        transition:all 0.1s;
        margin:0.5%;
        padding:0.5%;
        }
        .green {
        background:#66dd99;
        }
        .blue {
        background:#6666ff;
        }
        .red {
        background:#ff4466;
        }

        .shown {
        transition:all 0.1s;
        }

        .hidden {
        visibility:collapse;
        width:0;
        height:0;
        padding:0;
        margin:0;
        opacity:0;
        }

        input[type="radio"][id="blue"]:checked + label {
        background:#6666ff;
        }


        input[type="checkbox"]:checked + label {
        background:#66dd99;
        }
    </style>
</div>
<!-- END FILTER SELECTOR INCLUDE -->
